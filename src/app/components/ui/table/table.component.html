<div class="table-main-container">
  <div class="table-container">
    <table class="proptech-table">
      <thead>
        <tr>
          @if (selectable()) {
          <th class="checkbox-header">
            <input
              type="checkbox"
              [checked]="allRowsSelected()"
              [indeterminate]="someRowsSelected()"
              (click)="toggleAllRowsSelection()"
            />
          </th>
          } @for (column of columns(); track column.field) {
          <th>
            @if (column.headerTemplate) {
            <ng-container [ngTemplateOutlet]="column.headerTemplate"></ng-container>
            } @else {
            {{ column.header }}
            }
          </th>
          }
        </tr>
      </thead>
      <tbody>
        @for (row of data(); track row.id) {
        <tr
          [class.selected]="selectable() && isRowSelected(row)"
          [class.link]="!!rowLink()"
          (click)="onRowClick(row)"
        >
          @if (selectable()) {
          <td class="checkbox-cell">
            <input
              type="checkbox"
              [checked]="isRowSelected(row)"
              (click)="$event.stopPropagation(); toggleRowSelection(row)"
            />
          </td>
          } @for (column of columns(); track column.field) {
          <td>
            @if (column.cellTemplate) {
            <ng-container
              [ngTemplateOutlet]="column.cellTemplate"
              [ngTemplateOutletContext]="{ $implicit: row, column: column }"
            ></ng-container>
            } @else {
            {{ column.formatter ? column.formatter(row) : row[column.field] }}
            }
          </td>
          }
        </tr>
        }
      </tbody>
    </table>
  </div>
  @if (paginated()) {
  <div class="pagination-sticky">
    <div class="pagination-results">{{ totalResults() }} risultati</div>
    <div class="pagination-controls">
      <app-button
        text="Precedente"
        (clickEvent)="onPageChange(currentPage() - 1)"
        [disabled]="currentPage() === 1"
        variant="secondary"
      ></app-button>
      <span>Pagina {{ currentPage() }} di {{ totalPages() }}</span>
      <app-button
        text="Successiva"
        (clickEvent)="onPageChange(currentPage() + 1)"
        [disabled]="currentPage() === totalPages()"
        variant="secondary"
      ></app-button>
    </div>
  </div>
  }
</div>